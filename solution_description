In this solution we received data through the 'file' input plugin from 'securitylog.txt'. After the log file has been pulled into Logstash, it is then parsed using the 'grok' filter plugin. While 'grok' is parsing the file we also change the data type of 'source_ip' to IP from string. Once the file has been parsed and all relevant data has been saved we use the 'mutate' plugin to alter some data. First with 'mutate' we create a conditional statement to change the severity from "1", "2", or "3" to "HIGH", "MEDIUM'', or "LOW". The 'mutate' filter is also used to remove unnecessary data from the final output. Finally in the filter section we use the 'geoip' plugin to get geographical IP data for 'souce_ip'. The first plugin in the output section is the connection to the local elasticsearch instance. Then used ‘stdout’ to print to the console for quick troubleshooting. Lastly, there is a print to file, just to easily upload the output to the git repository. All data is formatted as a JSON.
